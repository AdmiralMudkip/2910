<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Frantic Frigate</title>
    </head>
    <body>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    
    <script>
        var context;
        
        window.onload = function() {
            var canvas = document.getElementById("canvas"); 
            context = canvas.getContext("2d");
            var img = document.getElementById("highscores"); 
            context.drawImage(img,0,0,1280,720); 
        }
        
        var i,j;
        var scores;
        var info;
        var data;

        // Get a number of top scores
        function getTopScores (ctx, callback, context) {
            console.log('pulling scores');
	     $.ajax({
                type: 'GET',
                dataType: 'json',
                url: 'https://highscore2910.herokuapp.com/scores/',
                success: function(data) {
                    scores = data;
                    
                    if (callback) callback();
		  },
		  error: function(xhr, msg) {
              console.error('AJAX error', xhr.status, msg);
                }
            });
            return scores;
        };
        
        // Post a score
        function postScore (ctx, name, time, callback) {
            console.log('Posting score', name, time);
            $.ajax({
                type: 'POST',
                url: 'https://highscore2910.herokuapp.com/scores/',
                data: {
                    name: name,
                    time: time,
                },
		  success: function(data) {
              console.log('Score posted', data);
              if (callback) callback();
          },
                error: function(xhr, msg) {
                    console.error('AJAX error', xhr.status, msg);
                }
	   });

        };
    
        getTopScores();
        //have to delay, because it takes a second to get the scores
        setTimeout(function(){timer(scores)}, 500);
            
        function timer(data) {
            console.log('After timer: ' + data);
            var newArray = 
            console.log('new ' + new1);
            console.log(new1);
            data.sort( predicatBy("string"));
            //data.sort(function(a,b) { return parseInt(a.time) - parseInt(b.time) } );
            console.log(data);
        }
        
        function predicatBy(prop){
            return function(a,b){
                if( a[prop] > b[prop]){
                    return 1;
                }else if( a[prop] < b[prop] ){
                    return -1;
                }
                return 0;
            }
        }


        
        //posting works!
        //postScore(context, 'POST', 30);
        
    </script>
    <canvas id="canvas" width="1280" height="720"></canvas>
    <img src = "images/scores1280.jpg" id="highscores" style="display:none">
    </body>
</html>